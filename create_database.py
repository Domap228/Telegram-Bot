import sqlite3


def create_new_database():
    conn = sqlite3.connect('universities.db')
    cursor = conn.cursor()

    cursor.execute("DROP TABLE IF EXISTS universities")

    cursor.execute('''
    CREATE TABLE universities (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        specialty TEXT,
        city TEXT,
        passing_score INTEGER,
        link TEXT
    )
    ''')

    universities_data = [
        ('–ú–ì–£ –∏–º. –ú.–í. –õ–æ–º–æ–Ω–æ—Å–æ–≤–∞', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ú–æ—Å–∫–≤–∞', 270, 'https://www.msu.ru'),
        ('–ù–ò–£ –í–®–≠', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ú–æ—Å–∫–≤–∞', 265, 'https://www.hse.ru'),
        ('–ú–§–¢–ò', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ú–æ—Å–∫–≤–∞', 280, 'https://mipt.ru'),
        ('–ú–ì–¢–£ –∏–º. –ë–∞—É–º–∞–Ω–∞', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ú–æ—Å–∫–≤–∞', 260, 'https://bmstu.ru'),
        ('–ú–ò–§–ò', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ú–æ—Å–∫–≤–∞', 255, 'https://mephi.ru'),
        ('–ú–ò–†–≠–ê', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ú–æ—Å–∫–≤–∞', 250, 'https://www.mirea.ru'),
        ('–ú–ê–ò', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ú–æ—Å–∫–≤–∞', 245, 'https://mai.ru'),

        ('–ù–ò–£ –í–®–≠', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 265, 'https://www.hse.ru'),
        ('–ú–ì–£ –∏–º. –ú.–í. –õ–æ–º–æ–Ω–æ—Å–æ–≤–∞', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 260, 'https://www.msu.ru'),
        ('–†–≠–£ –∏–º. –ü–ª–µ—Ö–∞–Ω–æ–≤–∞', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 250, 'https://www.rea.ru'),
        ('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 245, 'https://www.fa.ru'),
        ('–†–ê–ù–•–∏–ì–°', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 240, 'https://www.ranepa.ru'),
        ('–ú–ì–ò–ú–û', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 275, 'https://mgimo.ru'),

        ('–ú–ì–£ –∏–º. –ú.–í. –õ–æ–º–æ–Ω–æ—Å–æ–≤–∞', '–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è', '–ú–æ—Å–∫–≤–∞', 270, 'https://www.msu.ru'),
        ('–ú–ì–Æ–ê –∏–º. –ö—É—Ç–∞—Ñ–∏–Ω–∞', '–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è', '–ú–æ—Å–∫–≤–∞', 265, 'https://msal.ru'),
        ('–ù–ò–£ –í–®–≠', '–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è', '–ú–æ—Å–∫–≤–∞', 260, 'https://www.hse.ru'),
        ('–†–ê–ù–•–∏–ì–°', '–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è', '–ú–æ—Å–∫–≤–∞', 255, 'https://www.ranepa.ru'),
        ('–†–ì–£–ü', '–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è', '–ú–æ—Å–∫–≤–∞', 250, 'https://rgup.ru'),
        ('–ú–ì–ò–ú–û', '–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è', '–ú–æ—Å–∫–≤–∞', 280, 'https://mgimo.ru'),

        ('–ü–µ—Ä–≤—ã–π –ú–ì–ú–£ –∏–º. –°–µ—á–µ–Ω–æ–≤–∞', '–õ–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ', '–ú–æ—Å–∫–≤–∞', 290, 'https://www.sechenov.ru'),
        ('–†–ù–ò–ú–£ –∏–º. –ü–∏—Ä–æ–≥–æ–≤–∞', '–õ–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ', '–ú–æ—Å–∫–≤–∞', 285, 'https://rsmu.ru'),
        ('–ú–ì–ú–°–£ –∏–º. –ï–≤–¥–æ–∫–∏–º–æ–≤–∞', '–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è', '–ú–æ—Å–∫–≤–∞', 285, 'https://msmsu.ru'),
        ('–ú–û–ù–ò–ö–ò –∏–º. –í–ª–∞–¥–∏–º–∏—Ä—Å–∫–æ–≥–æ', '–õ–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ', '–ú–æ—Å–∫–≤–∞', 275, 'https://monikiweb.ru'),
        ('–†–£–î–ù', '–õ–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ', '–ú–æ—Å–∫–≤–∞', 270, 'https://www.rudn.ru'),

        ('–ú–ì–£ –∏–º. –ú.–í. –õ–æ–º–æ–Ω–æ—Å–æ–≤–∞', '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è', '–ú–æ—Å–∫–≤–∞', 255, 'https://www.msu.ru'),
        ('–ù–ò–£ –í–®–≠', '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è', '–ú–æ—Å–∫–≤–∞', 250, 'https://www.hse.ru'),
        ('–†–ì–ì–£', '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è', '–ú–æ—Å–∫–≤–∞', 245, 'https://rggu.ru'),
        ('–ú–ì–ü–ü–£', '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è', '–ú–æ—Å–∫–≤–∞', 235, 'https://mgppu.ru'),
        ('–ú–ü–ì–£', '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è', '–ú–æ—Å–∫–≤–∞', 230, 'https://mpgu.su'),

        ('–ú–ê—Ä—Ö–ò', '–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞', '–ú–æ—Å–∫–≤–∞', 260, 'https://markhi.ru'),
        ('–ú–ì–°–£', '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–ú–æ—Å–∫–≤–∞', 250, 'https://mgsu.ru'),
        ('–ù–ò–£ –ú–ì–°–£', '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–ú–æ—Å–∫–≤–∞', 245, 'https://mgsu.ru'),
        ('–ú–ò–°–ò', '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–ú–æ—Å–∫–≤–∞', 240, 'https://misi.ru'),
        ('–ì–£–ó', '–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞', '–ú–æ—Å–∫–≤–∞', 235, 'https://gu-z.ru'),

        ('–ú–ì–£ –∏–º. –ú.–í. –õ–æ–º–æ–Ω–æ—Å–æ–≤–∞', '–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 250, 'https://www.msu.ru'),
        ('–ú–ì–õ–£', '–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 245, 'https://linguanet.ru'),
        ('–ù–ò–£ –í–®–≠', '–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 240, 'https://www.hse.ru'),
        ('–ú–ü–ì–£', '–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 235, 'https://mpgu.su'),
        ('–†–ì–ì–£', '–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 230, 'https://rggu.ru'),

        ('–ù–ò–£ –í–®–≠', '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç', '–ú–æ—Å–∫–≤–∞', 265, 'https://www.hse.ru'),
        ('–ú–ì–£ –∏–º. –ú.–í. –õ–æ–º–æ–Ω–æ—Å–æ–≤–∞', '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç', '–ú–æ—Å–∫–≤–∞', 260, 'https://www.msu.ru'),
        ('–†–ê–ù–•–∏–ì–°', '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç', '–ú–æ—Å–∫–≤–∞', 255, 'https://www.ranepa.ru'),
        ('–†–≠–£ –∏–º. –ü–ª–µ—Ö–∞–Ω–æ–≤–∞', '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç', '–ú–æ—Å–∫–≤–∞', 250, 'https://www.rea.ru'),
        ('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç', '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç', '–ú–æ—Å–∫–≤–∞', 245, 'https://www.fa.ru'),
        ('–ú–ì–ò–ú–û', '–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç', '–ú–æ—Å–∫–≤–∞', 270, 'https://mgimo.ru'),

        ('–ú–ì–£ –∏–º. –ú.–í. –õ–æ–º–æ–Ω–æ—Å–æ–≤–∞', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 260, 'https://www.msu.ru'),
        ('–ù–ò–£ –í–®–≠', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 255, 'https://www.hse.ru'),
        ('–†–ì–ì–£', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 250, 'https://rggu.ru'),
        ('–ú–ì–ò–ú–û', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 270, 'https://mgimo.ru'),
        ('–†–ê–ù–•–∏–ì–°', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞', '–ú–æ—Å–∫–≤–∞', 245, 'https://www.ranepa.ru'),

        ('–ù–ò–£ –í–®–≠', '–î–∏–∑–∞–π–Ω', '–ú–æ—Å–∫–≤–∞', 255, 'https://www.hse.ru'),
        ('–ú–ì–•–ü–ê –∏–º. –°—Ç—Ä–æ–≥–∞–Ω–æ–≤–∞', '–î–∏–∑–∞–π–Ω', '–ú–æ—Å–∫–≤–∞', 250, 'https://mghpu.ru'),
        ('–ú–ê—Ä—Ö–ò', '–î–∏–∑–∞–π–Ω –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π —Å—Ä–µ–¥—ã', '–ú–æ—Å–∫–≤–∞', 245, 'https://markhi.ru'),
        ('–ë—Ä–∏—Ç–∞–Ω—Å–∫–∞—è –≤—ã—Å—à–∞—è —à–∫–æ–ª–∞ –¥–∏–∑–∞–π–Ω–∞', '–î–∏–∑–∞–π–Ω', '–ú–æ—Å–∫–≤–∞', 265, 'https://britishdesign.ru'),
        ('–ú–ì–£–î–¢', '–î–∏–∑–∞–π–Ω', '–ú–æ—Å–∫–≤–∞', 240, 'https://mgudt.ru'),

        ('–°–ü–±–ì–£', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', 260, 'https://spbu.ru'),
        ('–ò–¢–ú–û', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', 270, 'https://itmo.ru'),
        ('–°–ü–±–ì–£', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', 255, 'https://spbu.ru'),
        ('–ö–§–£', '–≠–∫–æ–Ω–æ–º–∏–∫–∞', '–ö–∞–∑–∞–Ω—å', 245, 'https://kpfu.ru'),
        ('–ù–ì–£', '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', 250, 'https://nsu.ru'),
    ]

    cursor.executemany(
        "INSERT INTO universities (name, specialty, city, passing_score, link) VALUES (?, ?, ?, ?, ?)",
        universities_data
    )

    conn.commit()

    cursor.execute("SELECT COUNT(DISTINCT specialty) FROM universities")
    specialties_count = cursor.fetchone()[0]

    cursor.execute("SELECT COUNT(*) FROM universities")
    total_count = cursor.fetchone()[0]

    cursor.execute("SELECT COUNT(*) FROM universities WHERE city = '–ú–æ—Å–∫–≤–∞'")
    moscow_count = cursor.fetchone()[0]

    print("‚úÖ –ù–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞!")
    print(f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"   –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π: {specialties_count}")
    print(f"   –í—Å–µ–≥–æ –≤—É–∑–æ–≤: {total_count}")
    print(f"   –í—É–∑–æ–≤ –≤ –ú–æ—Å–∫–≤–µ: {moscow_count} ({moscow_count / total_count * 100:.1f}%)")

    print("\nüìã –°–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π:")
    cursor.execute("SELECT DISTINCT specialty FROM universities ORDER BY specialty")
    specialties = cursor.fetchall()

    for i, (specialty,) in enumerate(specialties, 1):
        cursor.execute("SELECT COUNT(*) FROM universities WHERE specialty = ?", (specialty,))
        count = cursor.fetchone()[0]
        cursor.execute("SELECT COUNT(*) FROM universities WHERE specialty = ? AND city = '–ú–æ—Å–∫–≤–∞'", (specialty,))
        moscow = cursor.fetchone()[0]
        print(f"{i:2d}. {specialty} (–≤—Å–µ–≥–æ: {count}, –ú–æ—Å–∫–≤–∞: {moscow})")

    conn.close()


if __name__ == '__main__':
    create_new_database()